#!/data/data/com.termux/files/usr/bin/bash

## Author  : Javaz (mod dari Aditya Shakya)
## Github  : github.com/javazcript

## mod-jvz installer script

## ANSI Colors (FG & BG)
RED="$(printf '\033[31m')"  GREEN="$(printf '\033[32m')"  ORANGE="$(printf '\033[33m')"  BLUE="$(printf '\033[34m')"
MAGENTA="$(printf '\033[35m')"  CYAN="$(printf '\033[36m')"  WHITE="$(printf '\033[37m')" BLACK="$(printf '\033[30m')"
REDBG="$(printf '\033[41m')"  GREENBG="$(printf '\033[42m')"  ORANGEBG="$(printf '\033[43m')"  BLUEBG="$(printf '\033[44m')"
MAGENTABG="$(printf '\033[45m')"  CYANBG="$(printf '\033[46m')"  WHITEBG="$(printf '\033[47m')" BLACKBG="$(printf '\033[40m')"
DEFAULT_FG="$(printf '\033[39m')"  DEFAULT_BG="$(printf '\033[49m')"

USER=$(whoami)
HOSTNAME=$(hostname)
OS="Kali Linux"
UPTIME=$(uptime -p | sed 's/up //')
PACKAGES=$(dpkg --get-selections 2>/dev/null | wc -l)
[[ "$PACKAGES" -eq 0 ]] && PACKAGES=$(pacman -Q 2>/dev/null | wc -l)
SHELL=$(basename "$SHELL")
TERMINAL=$TERM
CPU=$(getprop ro.product.cpu.abi)
GPU=$(lspci 2>/dev/null | grep -i 'vga\|3d' | head -n1 | cut -d: -f3 | xargs)
MEM=$(free -m | awk '/Mem:/ {print $2 "MiB"}')
NOW=$(date +"%A, %d %B %Y %H:%M:%S")
MODEL=$(getprop ro.product.model)
## Directories
PREFIX='/data/data/com.termux/files/usr'
TERMUX_DIR="$HOME/.termux"
DIR="$(pwd)"

## Banner
banner () {
    clear
    echo "
${RED}⡏⠉⠛⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⣿
${RED}⣿⠀⠀⠀⠈⠛⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⠛⠉⠁⠀⣿
${RED}⣿⣧⡀⠀⠀⠀⠀⠙⠿⠿⠿⠻⠿⠿⠟⠿⠛⠉⠀⠀⠀⠀⠀⣸⣿
${RED}⣿⣿⣷⣄⠀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⣿⣿
${RED}⣿⣿⣿⣿⠏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠠⣴⣿⣿⣿⣿
${RED}⣿⣿⣿⡟⠀⠀⢰⣹⡆⠀⠀⠀⠀⠀⠀⣭⣷⠀⠀⠀⠸⣿⣿⣿⣿
${RED}⣿⣿⣿⠃⠀⠀⠈⠉⠀⠀⠤⠄⠀⠀⠀⠉⠁⠀⠀⠀⠀⢿⣿⣿⣿
${RED}⣿⣿⣿⢾⣿⣷⠀⠀⠀⠀⡠⠤⢄⠀⠀⠀⠠⣿⣿⣷⠀⢸⣿⣿⣿
${RED}⣿⣿⣿⡀⠉⠀⠀⠀⠀⠀⢄⠀⢀⠀⠀⠀⠀⠉⠉⠁⠀⠀⣿⣿⣿
${RED}⣿⣿⣿⣧⠀⠀⠀⠀⠀⠀⠀⠈⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢹⣿⣿
${RED}⣿⣿⣿⣿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿ 
${BLUE}  Script by Javaz — Custom Termux Style Installer
"
}

## Trap signal agar keluar rapi
exit_on_signal_SIGINT () {
    printf "\n\n%s\n" "    ${BLUE}[${RED}*${BLUE}] ${RED}Script interrupted."
    reset_color
    exit 0
}
exit_on_signal_SIGTERM () {
    printf "\n\n%s\n" "    ${BLUE}[${RED}*${BLUE}] ${RED}Script terminated."
    reset_color
    exit 0
}
trap exit_on_signal_SIGINT SIGINT
trap exit_on_signal_SIGTERM SIGTERM

## Reset terminal color
reset_color() {
	tput sgr0
	tput op
    return
}

## Install Dependencies
prerequisite() {
	echo -e "\n    ${BLUE}[${RED}*${BLUE}] ${ORANGE}Memeriksa dependensi..."
	if [[ (-f $PREFIX/bin/wget) && (-f $PREFIX/bin/tput) ]]; then
		echo "    ${BLUE}[${RED}*${BLUE}] ${GREEN}Dependensi sudah terinstall."
	else
		pkg update -y
		pkg install -y wget ncurses-utils
	fi
}

## Install mod-jvz (custom termux-style)
## Install mod-jvz (custom termux-style)
install_modjvz () {
	echo "    ${BLUE}[${RED}*${BLUE}] ${ORANGE}Menginstall mod-jvz..."
	# Hapus versi sebelumnya
	rm -f $PREFIX/bin/mod-jvz
	rm -rf $PREFIX/share/termux-style

	# Buat direktori .termux jika belum ada
	[[ ! -d $TERMUX_DIR ]] && mkdir $TERMUX_DIR || cp -r $TERMUX_DIR{,.backup}

	# Copy file style (dari direktori skrip)
	mkdir -p $PREFIX/share/termux-style
	cp -r $DIR/colors $PREFIX/share/termux-style
	cp -r $DIR/fonts $PREFIX/share/termux-style
	cp -r $DIR/tstyle $PREFIX/share/termux-style/mod-jvz

	# Set permission dan buat shortcut
	chmod +x $PREFIX/share/termux-style/mod-jvz
	ln -s $PREFIX/share/termux-style/mod-jvz $PREFIX/bin/mod-jvz

	# Buat custom MOTD
	cat > $PREFIX/etc/motd <<EOF
${CYAN}⠀⠀⠀⠀⠠⠤⠤⠤⠤⠤⣤⣤⣤⣄⣀⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀root@$(hostname)
${CYAN}⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠉⠛⠛⠿⢶⣤⣄⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀ OS       : $OS 
${CYAN}⠀⠀⢀⣀⣀⣠⣤⣤⣴⠶⠶⠶⠶⠶⠶⠶⠶⠶⠿⠿⢿⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀ Host     : $HOSTNAME
${CYAN}⠚⠛⠉⠉⠉⠀⠀⠀⠀⠀⠀⢀⣀⣀⣤⡴⠶⠶⠿⠿⠿⣧⡀⠀⠀⠀⠤⢄⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀ Perangkat: $MODEL
${CYAN}⠀⠀⠀⠀⠀⠀⠀⢀⣠⡴⠞⠛⠉⠁⠀⠀⠀⠀⠀⠀⠀⢸⣿⣷⣶⣦⣤⣄⣈⡑⢦⣀⠀⠀⠀⠀⠀⠀⠀ Uptime   : $UPTIME
${CYAN}⠀⠀⠀⠀⣠⠔⠚⠉⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣾⡿⠟⠉⠉⠉⠉⠙⠛⠿⣿⣮⣷⣤⠀⠀⠀⠀⠀ Packages : $PACKAGES
${CYAN}⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣿⡿⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⢻⣯⣧⡀⠀⠀ ⠀Shell    : $SHELL 
${CYAN}⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠻⢷⡤⠀⠀ Terminal :  $TERM
${CYAN}⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢿⣿⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀ CPU      : $CPU
${CYAN}⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠻⣿⣦⣤⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀ GPU      : Red Hat, Inc ⠀
${CYAN}⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠙⠛⠛⠻⠿⠿⣿⣶⣶⣦⣄⣀⠀⠀ ⠀⠀Memory   : $MEM
${CYAN}⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠻⣿⣯⡛⠻⢦⡀⠀ Date     : $NOW 
${CYAN}⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠙⢿⣆⠀⠙⢆ Author   : JAVAS 
${CYAN}⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢻⣆⠀⠈⢣
${CYAN}⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠻⡆⠀⠈
${CYAN}⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢻⡀⠀
${CYAN}⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠃⠀
${RED}                   [ J A V A S   𝕏   T E R M U X ]

${BLUE} We Are Anonymous ᥫ᭡
EOF
	# Verifikasi
	if [[ -L $PREFIX/bin/mod-jvz ]]; then
	
		echo -e "\n    ${BLUE}[${RED}*${BLUE}] ${GREEN}Berhasil diinstall!"
		echo "    ${BLUE}[${RED}*${BLUE}] ${GREEN}Jalankan dengan perintah: ${MAGENTA}mod-jvz"
	else
		echo "    ${BLUE}[${RED}!${BLUE}] ${RED}Terjadi kesalahan saat instalasi."
	fi
	reset_color
	exit 0
}
## Main
main () {
	banner
	prerequisite
	if [[ -L $PREFIX/bin/mod-jvz ]]; then
		echo -e "\n    ${BLUE}[${RED}!${BLUE}] ${MAGENTA}mod-jvz ${GREEN}sudah terinstall."
		read -p "    ${BLUE}[${RED}?${BLUE}] ${ORANGE}Ingin reinstall? (y/n): ${GREEN}" REPLY
		if [[ "$REPLY" =~ ^[yY]$ ]]; then
			install_modjvz
		else
			reset_color
			exit 0
		fi
	else
		install_modjvz
	fi
}

main an